<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🐴 馬肉 部位図ガイド（完成版）</title>
<style>
  :root {
    --bg: #fdeef0;
    --card: #fff;
    --accent: #f7b1b8;
    --text: #222;
    --ink: #d6336c;
  }

  body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: "Yu Gothic", "Hiragino Sans", sans-serif;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: flex-start;
    gap: 2rem;
    padding: 2rem;
    box-sizing: border-box;
  }

  .svgbox {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    max-width: 900px;
    background: #fff6;
    border-radius: 12px;
    position: relative;
  }

  .svgbox svg {
    width: 100%;
    height: auto;
    max-width: 900px;
    transition: all 0.2s ease;
  }

  /* 編集モードの丸 */
  .edit-dot {
    fill: white;
    stroke: #f06;
    stroke-width: 1.5;
    cursor: pointer;
  }

  .info-box {
    width: 340px;
    background: var(--card);
    padding: 1.6rem;
    border-radius: 12px;
    box-shadow: 0 2px 8px #0001;
  }

  .info-box h2 {
    color: var(--ink);
    margin-bottom: 0.6rem;
    border-bottom: 2px solid var(--accent);
    display: inline-block;
  }

  @media (max-width: 900px) {
    body {
      flex-direction: column;
      align-items: center;
    }
    .info-box {
      width: 90%;
    }
  }
</style>
</head>
<body>

<div class="svgbox" id="svgContainer">
  <img src="screenshot-2025-10-20-203144.svg" id="horseMap" alt="馬肉部位図">
</div>

<div class="info-box">
  <h2>馬肉 部位図</h2>
  <p id="guide">部位を選択してください</p>
  <div id="desc"></div>
</div>

<script>
// ============================
// 設定エリア（説明文）
// ============================
const partsInfo = {
  "たてがみ": "ぷるぷるとした食感でコラーゲンが豊富。赤身と一緒に食べると最高のバランス。",
  "ネック": "昔ながらの赤身。噛むほど旨み。ユッケ・タタキなどに最適。",
  "ロース": "赤身と脂のバランスがよく、刺身や焼きにも最適。",
  "ヒレ": "最も柔らかい希少部位。上品で甘みのある味。",
  "バラ": "旨みが強く煮込み料理向き。人気部位。",
  "ラム": "後ろ腰部の赤身。程よい歯ごたえと濃厚な旨味。"
};

// ============================
// 編集モード判定
// ============================
const urlParams = new URLSearchParams(window.location.search);
const editMode = urlParams.get("edit") === "1";

// ============================
// SVG画像をロードしてクリック範囲設定
// ============================
const container = document.getElementById("svgContainer");
const img = document.getElementById("horseMap");
const descBox = document.getElementById("desc");
const guideText = document.getElementById("guide");

img.onload = () => {
  const svgRect = container.getBoundingClientRect();

  // 部位クリック範囲（座標）
  const areas = {
    "たてがみ": {x:180, y:100, w:180, h:60},
    "ネック": {x:240, y:170, w:220, h:80},
    "ロース": {x:420, y:180, w:180, h:70},
    "ヒレ": {x:440, y:250, w:140, h:60},
    "バラ": {x:370, y:300, w:160, h:80},
    "ラム": {x:620, y:200, w:130, h:90}
  };

  const svgNS = "http://www.w3.org/2000/svg";
  const overlay = document.createElementNS(svgNS, "svg");
  overlay.setAttribute("width", "100%");
  overlay.setAttribute("height", "100%");
  overlay.style.position = "absolute";
  overlay.style.top = 0;
  overlay.style.left = 0;
  container.appendChild(overlay);

  for (const [name, pos] of Object.entries(areas)) {
    const rect = document.createElementNS(svgNS, "rect");
    rect.setAttribute("x", pos.x);
    rect.setAttribute("y", pos.y);
    rect.setAttribute("width", pos.w);
    rect.setAttribute("height", pos.h);
    rect.setAttribute("fill", "rgba(255,0,100,0.15)");
    rect.style.cursor = "pointer";
    rect.style.transition = "0.2s";
    rect.setAttribute("data-name", name);

    // hover時の反応
    rect.addEventListener("mouseenter", ()=>{
      rect.setAttribute("fill", "rgba(255,0,100,0.35)");
    });
    rect.addEventListener("mouseleave", ()=>{
      rect.setAttribute("fill", "rgba(255,0,100,0.15)");
    });

    // click or touchstartで説明表示
    const activate = ()=>{
      guideText.innerHTML = `<b>${name}</b>`;
      descBox.textContent = partsInfo[name] || "説明が未登録です。";
    };
    rect.addEventListener("click", activate);
    rect.addEventListener("touchstart", e=>{
      e.preventDefault();
      activate();
    });

    // 編集モードなら丸出す
    if (editMode) {
      const dot = document.createElementNS(svgNS, "circle");
      dot.classList.add("edit-dot");
      dot.setAttribute("cx", pos.x + pos.w/2);
      dot.setAttribute("cy", pos.y + pos.h/2);
      dot.setAttribute("r", 6);
      overlay.appendChild(dot);
    }

    overlay.appendChild(rect);
  }
};
</script>

</body>
</html>
